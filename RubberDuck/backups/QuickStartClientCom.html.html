<html>
<head>
<title>QuickStartClientCom.html</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #e8bf6a;}
.s1 { color: #a9b7c6;}
.s2 { color: #bababa;}
.s3 { color: #a5c261;}
.s4 { color: #6d9cbe;}
.ln { color: #606366; font-weight: normal; font-style: normal; }
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
QuickStartClientCom.html</font>
</center></td></tr></table>
<pre><a name="l1"><span class="ln">1    </span></a><span class="s0">&lt;HTML&gt;</span>
<a name="l2"><span class="ln">2    </span></a><span class="s0">&lt;HEAD&gt;</span>
<a name="l3"><span class="ln">3    </span></a><span class="s0">&lt;META </span><span class="s2">HTTP-EQUIV</span><span class="s3">=&quot;Content-Type&quot; </span><span class="s2">CONTENT</span><span class="s3">=&quot;text/html; charset=windows-1252&quot;</span><span class="s0">&gt;</span>
<a name="l4"><span class="ln">4    </span></a><span class="s0">&lt;META </span><span class="s2">NAME</span><span class="s3">=&quot;Generator&quot; </span><span class="s2">CONTENT</span><span class="s3">=&quot;Microsoft Word 97&quot;</span><span class="s0">&gt;</span>
<a name="l5"><span class="ln">5    </span></a><span class="s0">&lt;TITLE&gt;</span><span class="s1">Quick Start to Client side COM and Python</span><span class="s0">&lt;/TITLE&gt;</span>
<a name="l6"><span class="ln">6    </span></a><span class="s0">&lt;META </span><span class="s2">NAME</span><span class="s3">=&quot;Template&quot; </span><span class="s2">CONTENT</span><span class="s3">=&quot;D:\Program Files\Microsoft Office\Office\html.dot&quot;</span><span class="s0">&gt;</span>
<a name="l7"><span class="ln">7    </span></a><span class="s0">&lt;/HEAD&gt;</span>
<a name="l8"><span class="ln">8    </span></a><span class="s0">&lt;BODY </span><span class="s2">LINK</span><span class="s3">=&quot;#0000ff&quot; </span><span class="s2">VLINK</span><span class="s3">=&quot;#800080&quot;</span><span class="s0">&gt;</span>
<a name="l9"><span class="ln">9    </span></a>
<a name="l10"><span class="ln">10   </span></a><span class="s0">&lt;H1&gt;</span><span class="s1">Quick Start to Client side COM and Python</span><span class="s0">&lt;/H1&gt;</span>
<a name="l11"><span class="ln">11   </span></a><span class="s0">&lt;H2&gt;</span><span class="s1">Introduction</span><span class="s0">&lt;/H2&gt;</span>
<a name="l12"><span class="ln">12   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">This documents how to quickly start using COM from Python. It is not a thorough discussion of the COM system, or of the concepts introduced by COM.</span><span class="s0">&lt;/P&gt;</span>
<a name="l13"><span class="ln">13   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">Other good information on COM can be found in various conference tutorials - please see </span><span class="s0">&lt;A </span><span class="s2">HREF</span><span class="s3">=&quot;http://starship.python.net/crew/mhammond/conferences&quot;</span><span class="s0">&gt;</span><span class="s1">the collection of Mark's conference tutorials</span><span class="s0">&lt;/A&gt;&lt;/P&gt;</span>
<a name="l14"><span class="ln">14   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">For information on implementing COM objects using Python, please see </span><span class="s0">&lt;A </span><span class="s2">HREF</span><span class="s3">=&quot;http://www.python.org/windows/win32com/QuickStartServerCom.html&quot;</span><span class="s0">&gt;</span><span class="s1">a Quick Start to Server side COM and Python</span><span class="s0">&lt;/A&gt;&lt;/P&gt;</span>
<a name="l15"><span class="ln">15   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">In this document we discuss the following topics:</span><span class="s0">&lt;/P&gt;</span>
<a name="l16"><span class="ln">16   </span></a>
<a name="l17"><span class="ln">17   </span></a><span class="s0">&lt;UL&gt;</span>
<a name="l18"><span class="ln">18   </span></a><span class="s0">&lt;LI&gt;&lt;A </span><span class="s2">HREF</span><span class="s3">=&quot;#Using&quot;</span><span class="s0">&gt;</span><span class="s1">Using a COM object from Python</span><span class="s0">&lt;/A&gt; &lt;/LI&gt;</span>
<a name="l19"><span class="ln">19   </span></a><span class="s0">&lt;LI&gt;&lt;A </span><span class="s2">HREF</span><span class="s3">=&quot;#WhatObjects&quot;</span><span class="s0">&gt;</span><span class="s1">How do I know which objects are available?</span><span class="s0">&lt;/A&gt; &lt;/LI&gt;</span>
<a name="l20"><span class="ln">20   </span></a><span class="s0">&lt;LI&gt;&lt;A </span><span class="s2">HREF</span><span class="s3">=&quot;#StaticDispatch&quot;</span><span class="s0">&gt;</span><span class="s1">Static Dispatch/Type Safe objects (using the new improved makepy.py)</span><span class="s0">&lt;/A&gt;&lt;/LI&gt;</span>
<a name="l21"><span class="ln">21   </span></a><span class="s0">&lt;LI&gt;&lt;A </span><span class="s2">HREF</span><span class="s3">=&quot;#UsingComConstants&quot;</span><span class="s0">&gt;</span><span class="s1">Using COM Constants with makepy.</span><span class="s0">&lt;/A&gt;&lt;/LI&gt;&lt;/UL&gt;</span>
<a name="l22"><span class="ln">22   </span></a>
<a name="l23"><span class="ln">23   </span></a><span class="s0">&lt;H2&gt;</span><span class="s1">Quick Start</span><span class="s0">&lt;/H2&gt;</span>
<a name="l24"><span class="ln">24   </span></a><span class="s0">&lt;H3&gt;&lt;A </span><span class="s2">NAME</span><span class="s3">=&quot;Using&quot;</span><span class="s0">&gt;</span><span class="s1">To use a COM object from Python</span><span class="s0">&lt;/A&gt;&lt;/H3&gt;</span>
<a name="l25"><span class="ln">25   </span></a><span class="s0">&lt;CODE&gt;&lt;P&gt;</span><span class="s1">import win32com.client</span><span class="s0">&lt;BR&gt;</span>
<a name="l26"><span class="ln">26   </span></a><span class="s1">o = win32com.client.Dispatch(&quot;Object.Name&quot;)</span><span class="s0">&lt;BR&gt;</span>
<a name="l27"><span class="ln">27   </span></a><span class="s1">o.Method()</span><span class="s0">&lt;BR&gt;</span>
<a name="l28"><span class="ln">28   </span></a><span class="s1">o.property = &quot;New Value&quot;</span><span class="s0">&lt;BR&gt;</span>
<a name="l29"><span class="ln">29   </span></a><span class="s1">print o.property</span><span class="s0">&lt;/P&gt;</span>
<a name="l30"><span class="ln">30   </span></a><span class="s0">&lt;/CODE&gt;&lt;P&gt;</span><span class="s1">Example</span><span class="s0">&lt;/P&gt;</span>
<a name="l31"><span class="ln">31   </span></a><span class="s0">&lt;CODE&gt;&lt;P&gt;</span><span class="s1">o = win32com.client.Dispatch(&quot;Excel.Application&quot;)</span><span class="s0">&lt;BR&gt;</span>
<a name="l32"><span class="ln">32   </span></a><span class="s1">o.Visible = 1</span><span class="s0">&lt;BR&gt;</span>
<a name="l33"><span class="ln">33   </span></a><span class="s1">o.Workbooks.Add() # for office 97 â€“ 95 a bit different!</span><span class="s0">&lt;BR&gt;</span>
<a name="l34"><span class="ln">34   </span></a><span class="s1">o.Cells(1,1).Value = &quot;Hello&quot;</span><span class="s0">&lt;/CODE&gt; &lt;/P&gt;</span>
<a name="l35"><span class="ln">35   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">And we will see the word &quot;Hello&quot; appear in the top cell. </span><span class="s0">&lt;/P&gt;</span>
<a name="l36"><span class="ln">36   </span></a><span class="s0">&lt;H3&gt;&lt;A </span><span class="s2">NAME</span><span class="s3">=&quot;WhatObjects&quot;</span><span class="s0">&gt;</span><span class="s1">How do I know which methods and properties are available?</span><span class="s0">&lt;/A&gt;&lt;/H3&gt;</span>
<a name="l37"><span class="ln">37   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">Good question. This is hard! You need to use the documentation with the products, or possibly a COM browser. Note however that COM browsers typically rely on these objects registering themselves in certain ways, and many objects to not do this. You are just expected to know.</span><span class="s0">&lt;/P&gt;</span>
<a name="l38"><span class="ln">38   </span></a><span class="s0">&lt;H4&gt;</span><span class="s1">The Python COM browser</span><span class="s0">&lt;/H4&gt;</span>
<a name="l39"><span class="ln">39   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">PythonCOM comes with a basic COM browser that may show you the information you need. Note that this package requires Pythonwin (ie, the MFC GUI environment) to be installed for this to work.</span><span class="s0">&lt;/P&gt;</span>
<a name="l40"><span class="ln">40   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">There are far better COM browsers available - I tend to use the one that comes with MSVC, or this one!</span><span class="s0">&lt;/P&gt;</span>
<a name="l41"><span class="ln">41   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">To run the browser, simply select it from the Pythonwin </span><span class="s0">&lt;I&gt;</span><span class="s1">Tools</span><span class="s0">&lt;/I&gt; </span><span class="s1">menu, or double-click on the file </span><span class="s0">&lt;I&gt;</span><span class="s1">win32com\client\combrowse.py</span><span class="s0">&lt;/I&gt;&lt;/P&gt;</span>
<a name="l42"><span class="ln">42   </span></a><span class="s0">&lt;H2&gt;&lt;A </span><span class="s2">NAME</span><span class="s3">=&quot;StaticDispatch&quot;</span><span class="s0">&gt;</span><span class="s1">Static Dispatch (or Type Safe) objects</span><span class="s0">&lt;/A&gt;&lt;/H2&gt;</span>
<a name="l43"><span class="ln">43   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">In the above examples, if we printed the '</span><span class="s0">&lt;CODE&gt;</span><span class="s1">repr(o)</span><span class="s0">&lt;/CODE&gt;</span><span class="s1">' object above, it would have resulted in</span><span class="s0">&lt;/P&gt;</span>
<a name="l44"><span class="ln">44   </span></a><span class="s0">&lt;CODE&gt;&lt;P&gt;</span><span class="s4">&amp;lt;</span><span class="s1">COMObject Excel.Application</span><span class="s4">&amp;gt;</span><span class="s0">&lt;/P&gt;</span>
<a name="l45"><span class="ln">45   </span></a><span class="s0">&lt;/CODE&gt;&lt;P&gt;</span><span class="s1">This reflects that the object is a generic COM object that Python has no special knowledge of (other than the name you used to create it!). This is known as a &quot;dynamic dispatch&quot; object, as all knowledge is built dynamically. The win32com package also has the concept of </span><span class="s0">&lt;I&gt;</span><span class="s1">static dispatch</span><span class="s0">&lt;/I&gt; </span><span class="s1">objects, which gives Python up-front knowledge about the objects that it is working with (including arguments, argument types, etc)</span><span class="s0">&lt;/P&gt;</span>
<a name="l46"><span class="ln">46   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">In a nutshell, Static Dispatch involves the generation of a .py file that contains support for the specific object. For more overview information, please see the documentation references above.</span><span class="s0">&lt;/P&gt;</span>
<a name="l47"><span class="ln">47   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">The generation and management of the .py files is somewhat automatic, and involves one of 2 steps:</span><span class="s0">&lt;/P&gt;</span>
<a name="l48"><span class="ln">48   </span></a>
<a name="l49"><span class="ln">49   </span></a><span class="s0">&lt;UL&gt;</span>
<a name="l50"><span class="ln">50   </span></a><span class="s0">&lt;LI&gt;</span><span class="s1">Using </span><span class="s0">&lt;I&gt;</span><span class="s1">makepy.py</span><span class="s0">&lt;/I&gt; </span><span class="s1">to select a COM library. This process is very similar to Visual Basic, where you select from a list of all objects installed on your system, and once selected the objects are magically useable. </span><span class="s0">&lt;/LI&gt;&lt;/UL&gt;</span>
<a name="l51"><span class="ln">51   </span></a>
<a name="l52"><span class="ln">52   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">or</span><span class="s0">&lt;/P&gt;</span>
<a name="l53"><span class="ln">53   </span></a>
<a name="l54"><span class="ln">54   </span></a><span class="s0">&lt;UL&gt;</span>
<a name="l55"><span class="ln">55   </span></a><span class="s0">&lt;LI&gt;</span><span class="s1">Use explicit code to check for, and possibly generate, support at run-time. This is very powerful, as it allows the developer to avoid ensuring the user has selected the appropriate type library. This option is extremely powerful for OCX users, as it allows Python code to sub-class an OCX control, but the actual sub-class can be generated at run-time.  Use </span><span class="s0">&lt;I&gt;</span><span class="s1">makepy.py</span><span class="s0">&lt;/I&gt; </span><span class="s1">with a </span><span class="s0">&lt;/I&gt;</span><span class="s1">-i</span><span class="s0">&lt;/I&gt; </span><span class="s1">option to see how to include this support in your Python code.</span><span class="s0">&lt;/LI&gt;&lt;/UL&gt;</span>
<a name="l56"><span class="ln">56   </span></a>
<a name="l57"><span class="ln">57   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">The </span><span class="s0">&lt;I&gt;</span><span class="s1">win32com.client.gencache</span><span class="s0">&lt;/I&gt; </span><span class="s1">module manages these generated files. This module has </span><span class="s0">&lt;A </span><span class="s2">HREF</span><span class="s3">=&quot;GeneratedSupport.html&quot;</span><span class="s0">&gt;</span><span class="s1">some documentation of its own</span><span class="s0">&lt;/A&gt;</span><span class="s1">, but you probably don't need to know the gory details!</span><span class="s0">&lt;/P&gt;</span>
<a name="l58"><span class="ln">58   </span></a><span class="s0">&lt;H3&gt;</span><span class="s1">How do I get at the generated module?</span><span class="s0">&lt;/H3&gt;</span>
<a name="l59"><span class="ln">59   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">You will notice that the generated file name is long and cryptic - obviously not designed for humans to work with! So how do you get at the module object for the generated code?</span><span class="s0">&lt;/P&gt;</span>
<a name="l60"><span class="ln">60   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">Hopefully, the answer is </span><span class="s0">&lt;I&gt;</span><span class="s1">you shouldn't need to</span><span class="s0">&lt;/I&gt;</span><span class="s1">.  All generated file support is generally available directly via </span><span class="s0">&lt;I&gt;</span><span class="s1">win32com.client.Dispatch</span><span class="s0">&lt;/I&gt; </span><span class="s1">and </span><span class="s0">&lt;I&gt;</span><span class="s1">win32com.client.constants</span><span class="s0">&lt;/I&gt;</span><span class="s1">.  But should you ever really need the Python module object, the win32com.client.gencache module has functions specifically for this. The functions GetModuleForCLSID and GetModuleForProgID both return Python module objects that you can use in your code. See the docstrings in the gencache code for more details.</span><span class="s0">&lt;/P&gt;</span>
<a name="l61"><span class="ln">61   </span></a><span class="s0">&lt;H3&gt;</span><span class="s1">To generate Python Sources supporting a COM object</span><span class="s0">&lt;/H3&gt;</span>
<a name="l62"><span class="ln">62   </span></a><span class="s0">&lt;H4&gt;</span><span class="s1">Example using Microsoft Office 97.</span><span class="s0">&lt;/H4&gt;</span>
<a name="l63"><span class="ln">63   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">Either:</span><span class="s0">&lt;/P&gt;</span>
<a name="l64"><span class="ln">64   </span></a>
<a name="l65"><span class="ln">65   </span></a><span class="s0">&lt;UL&gt;</span>
<a name="l66"><span class="ln">66   </span></a><span class="s0">&lt;LI&gt;</span><span class="s1">Run '</span><span class="s0">&lt;CODE&gt;</span><span class="s1">win32com\client\makepy.py</span><span class="s0">&lt;/CODE&gt;</span><span class="s1">' (eg, run it from the command window, or double-click on it) and a list will be presented. Select the Type Library '</span><span class="s0">&lt;CODE&gt;</span><span class="s1">Microsoft Word 8.0 Object Library</span><span class="s0">&lt;/CODE&gt;</span><span class="s1">' </span><span class="s0">&lt;/LI&gt;</span>
<a name="l67"><span class="ln">67   </span></a><span class="s0">&lt;LI&gt;</span><span class="s1">From a command prompt, run the command '</span><span class="s0">&lt;CODE&gt;</span><span class="s1">makepy.py &quot;Microsoft Word 8.0 Object Library&quot;</span><span class="s0">&lt;/CODE&gt;</span><span class="s1">' (include the double quotes). This simply avoids the selection process. </span><span class="s0">&lt;/LI&gt;</span>
<a name="l68"><span class="ln">68   </span></a><span class="s0">&lt;LI&gt;</span><span class="s1">If you desire, you can also use explicit code to generate it just before you need to use it at runtime.  Run </span><span class="s0">&lt;CODE&gt;</span><span class="s1">'makepy.py -i &quot;Microsoft Word 8.0 Object Library&quot;</span><span class="s0">&lt;/CODE&gt;</span><span class="s1">' (include the double quotes) to see how to do this.</span><span class="s0">&lt;/LI&gt;&lt;/UL&gt;</span>
<a name="l69"><span class="ln">69   </span></a>
<a name="l70"><span class="ln">70   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">And that is it! Nothing more needed. No special import statements needed! Now, you simply need say</span><span class="s0">&lt;/P&gt;</span>
<a name="l71"><span class="ln">71   </span></a><span class="s0">&lt;CODE&gt;&lt;P&gt;</span><span class="s4">&amp;gt;&amp;gt;&amp;gt; </span><span class="s1">import win32com.client</span><span class="s0">&lt;/P&gt;</span>
<a name="l72"><span class="ln">72   </span></a><span class="s0">&lt;P&gt;</span><span class="s4">&amp;gt;&amp;gt;&amp;gt; </span><span class="s1">w=win32com.client.Dispatch(&quot;Word.Application&quot;)</span><span class="s0">&lt;/P&gt;</span>
<a name="l73"><span class="ln">73   </span></a><span class="s0">&lt;P&gt;</span><span class="s4">&amp;gt;&amp;gt;&amp;gt; </span><span class="s1">w.Visible=1</span><span class="s0">&lt;/P&gt;</span>
<a name="l74"><span class="ln">74   </span></a><span class="s0">&lt;P&gt;</span><span class="s4">&amp;gt;&amp;gt;&amp;gt; </span><span class="s1">w</span><span class="s0">&lt;/P&gt;</span>
<a name="l75"><span class="ln">75   </span></a><span class="s0">&lt;P&gt;</span><span class="s4">&amp;lt;</span><span class="s1">win32com.gen_py.Microsoft Word 8.0 Object Library._Application</span><span class="s4">&amp;gt;</span><span class="s0">&lt;/P&gt;</span>
<a name="l76"><span class="ln">76   </span></a><span class="s0">&lt;/CODE&gt;&lt;P&gt;</span><span class="s1">Note that now Python knows the explicit type of the object.</span><span class="s0">&lt;/P&gt;</span>
<a name="l77"><span class="ln">77   </span></a><span class="s0">&lt;H3&gt;&lt;A </span><span class="s2">NAME</span><span class="s3">=&quot;UsingComConstants&quot;</span><span class="s0">&gt;</span><span class="s1">Using COM Constants</span><span class="s0">&lt;/A&gt;&lt;/H3&gt;</span>
<a name="l78"><span class="ln">78   </span></a><span class="s0">&lt;P&gt;</span><span class="s1">Makepy automatically installs all generated constants from a type library in an object called </span><span class="s0">&lt;I&gt;</span><span class="s1">win32com.clients.constants</span><span class="s0">&lt;/I&gt;</span><span class="s1">.  You do not need to do anything special to make these constants work, other than create the object itself (ie, in the example above, the constants relating to </span><span class="s0">&lt;I&gt;</span><span class="s1">Word</span><span class="s0">&lt;/I&gt; </span><span class="s1">would automatically be available after the </span><span class="s0">&lt;CODE&gt;</span><span class="s1">w=win32com.client.Dispatch(&quot;Word.Application</span><span class="s0">&lt;/CODE&gt;</span><span class="s1">&quot;) statement</span><span class="s0">&lt;CODE&gt;</span><span class="s1">.</span><span class="s0">&lt;/P&gt;</span>
<a name="l79"><span class="ln">79   </span></a><span class="s0">&lt;/CODE&gt;&lt;P&gt;</span><span class="s1">For example, immediately after executing the code above, you could execute the following:</span><span class="s0">&lt;/P&gt;</span>
<a name="l80"><span class="ln">80   </span></a><span class="s0">&lt;CODE&gt;&lt;P&gt;</span><span class="s4">&amp;gt;&amp;gt;&amp;gt; </span><span class="s1">w.WindowState = win32com.client.constants.wdWindowStateMinimize</span><span class="s0">&lt;/P&gt;</span>
<a name="l81"><span class="ln">81   </span></a><span class="s0">&lt;/CODE&gt;&lt;P&gt;</span><span class="s1">and Word will Minimize.</span><span class="s0">&lt;/P&gt;&lt;/BODY&gt;</span>
<a name="l82"><span class="ln">82   </span></a><span class="s0">&lt;/HTML&gt;</span>
<a name="l83"><span class="ln">83   </span></a></pre>
</body>
</html>